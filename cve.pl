#!/usr/bin/env perl
use strict;
use warnings;
use utf8;
use Term::ANSIColor;
use Config::Tiny;

binmode STDOUT, ":utf8";

use FindBin 1.51 qw( $RealBin );
use lib "$RealBin/lib";
use lib "$RealBin/perl5";

use Bot::CVE;
use Command::Help;
use Command::Eval;
use Command::Feed;
use Command::Close;
use Command::CVE;
use Command::Match;
use Command::Voice;
use Command::Assign;
use Command::Assigned;
use Command::Restart;
use Command::Status;
use Command::Search;
use Command::Report;
use Command::Show;

print "\n" . localtime(time) . color('green') . " STARTING MOFO\n" . color('reset');

my $config = Config::Tiny->read('config.ini', 'utf8');

print localtime(time) . " Loaded Config: config.ini\n";

my $bot = Bot::CVE->new('config' => $config);
$bot->add_command( Command::Help->new            ('bot' => $bot) );
$bot->add_command( Command::Eval->new            ('bot' => $bot) );
$bot->add_command( Command::Feed->new            ('bot' => $bot) );
$bot->add_command( Command::Close->new           ('bot' => $bot) );
$bot->add_command( Command::CVE->new             ('bot' => $bot) );
$bot->add_command( Command::Match->new           ('bot' => $bot) );
$bot->add_command( Command::Assign->new          ('bot' => $bot) );
$bot->add_command( Command::Assigned->new        ('bot' => $bot) );
$bot->add_command( Command::Restart->new         ('bot' => $bot) );
$bot->add_command( Command::Status->new          ('bot' => $bot) );
$bot->add_command( Command::Search->new          ('bot' => $bot) );
$bot->add_command( Command::Report->new          ('bot' => $bot) );
$bot->add_command( Command::Show->new            ('bot' => $bot) );

$bot->start();
